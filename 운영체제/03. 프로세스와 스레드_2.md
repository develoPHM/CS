# 커널 영역

---

## PCB 와 문맥 교환

운영체제가 메모리에 적재된 다수의 프로세스를 관리하려면 프로세스를 식별할 수 있는 커널 영역 내의 정보가 필요하다. 이 정보가 바로 **프로세스 제어 블록 ( PCB )** 라고 한다.

PCB 는 프로세스와 관련된 다양한 정보를 내포하는 구조체의 일종으로, 새로운 프로세스가 메모리에 적재됐을 때 커널 영역에 만들어지고, 프로세스의 실행이 끝나면 폐기됩니다.

## PCB

PCB 에 담기는 정보는 운영체제마다 차이가 있지만, 대표적으로 프로세스 식별 번호인 프로세스 ID ( **PID** ), 프로세스가 실행 과정에서 사용한 **레지스터 값**, 프로세스가 현재 어떤 상태인지를 나타내는 **프로세스 상태**, 프로세스의 메모리상 적재 위치를 알 수 있는 **메모리 관련 정보**, 프로세스가 사용한 **파일 및 입출력장치 관련 정보**가 명시된다.

## PCB 테이블

프로세스 테이블은 실행 중인 PCB 의 모음을 의미합니다. 새롭게 실행되는 프로세스가 있다면 해당 프로세스의 PCB 를 프로세스 테이블에 추가하고, 필요한 자원을 할당합니다.

종료되는 프로세스가 있다면 사용 중이던 자원을 해제하고 PCB 도 프로세스 테이블에서 삭제됩니다.

---

## 타이머 인터럽트, 문맥 교환

일반적으로 메모리에 적재된 프로세스들은 한정된 시간 동안 번갈아 가며 실행된다. 이때 **프로세스가 실행된다는 말은 운영체제에 의해 CPU 의 자원을 할당받았다**는 말과 같다.

즉 ‘ 다양한 프로세스들이 한정된 시간 동안 번갈아 가며 실행된다’ 는 말은 ‘다양한 프로세스들이 한정된 시간 동안 운영체제로부터 CPU 의 자원을 번갈아 가며 할당받아서 이용한다’ 는 말과 같다.

프로세스의 CPU 사용 시간은 타이머 인터럽트에 의해 제한된다. **타이머 인터럽트**란 시간이 끝났음을 알리는 인터럽트로, **타임아웃 인터럽트라고도 부른다.**

예를 들어, 프로세스 A가 운영체제로부터 CPU를 할당받아 실행되다가, 타이머 인터럽트가 발생하여 프로세스 B로 CPU 사용을 양보한다고 가정해 본다. 이때 프로세스 A는 프로그램 카운터를 비롯한 각종 레지스터 값과 메모리 정보, 실행을 위해 열었던 파일, 사용한 입출력장치 등 지금까지의 중간 정보를 백업해야 한다. 그래야 다음에 다시 프로세스 A를 실행할 차례가 되었을 때 이전까지 실행했던 내용을 이어서 재개할 수 있을 테니까.

여기서 백업 대상이 되는 중간 정보, 즉 **프로세스의 수행을 재개하기 위해 기억해야 할 정보를 문맥**이라고 한다. 프로세스의 문맥은 해당 프로세스의 PCB에 명시된다.

이처럼 기존 프로세스의 문맥을 PCB에 백업하고, PCB에서 문맥을 복구하여 새로운 프로세스를 실행하는 것을 **문맥 교환**이라고 한다.